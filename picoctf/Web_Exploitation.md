# Web Exploitation
## Challenge 1: cookies
On clicking the link in the challenge description, the following website was opened.

<img width="1458" alt="image" src="https://github.com/user-attachments/assets/a5013cc8-87a9-4bee-b051-3f3e00961fa3">

I opened the inspect element, went to networks and then check. Then I entered snickerdoodle as it was suggested in the searchbox.

<img width="1458" alt="image" src="https://github.com/user-attachments/assets/2835f6f7-ad3a-43bd-9624-5fdf7b63d64d">

In check, the cookie was set to name=0. I clicked on the home option and tried entering names of other cookies. Typing gingerbread gave the following result:

<img width="1458" alt="image" src="https://github.com/user-attachments/assets/9aeec56a-c531-40fd-b212-53d6dd71e81b">

Now cookie was set to name=23. I then went to burpsuite, opened a browser and entered the url. I opened the inspect command again, entered gingerbread in the searchbox and copied the request url for check in networks. I turned On the intercept and entered the request url on a new tab on the opened browser.

<img width="1470" alt="image" src="https://github.com/user-attachments/assets/3fed5912-8b8d-4ce3-8e9a-32b853b9d6df">

I sent this request to repeater and tried changing the name value a few times to see the different cookie names.

<img width="726" alt="image" src="https://github.com/user-attachments/assets/a8ae2021-10ed-46e0-a90d-ff58d9cd38cd">

Then I sent the request to the intruder for an attack. I set the payload position at the value of name and set the payload type to number. Then I set the number range form -1 to 25 and started the attack.  

<img width="726" alt="image" src="https://github.com/user-attachments/assets/1c7004be-60b2-4fb6-9d48-2420e1b0c8f5">
<img width="1454" alt="image" src="https://github.com/user-attachments/assets/32c559c7-e6d3-46e3-982c-935f3bebcc2d">

The length at the 18th payload seemed unusual. So I changed the name value to 18 and got the following response:

<img width="730" alt="image" src="https://github.com/user-attachments/assets/d4838df9-e990-482f-a2cb-9ca7fb99a691">
The flag was given.

-New concepts
1. I learned how to use the intruder to attack a wesite.

References: [intruder](https://portswigger.net/burp/documentation/desktop/tools/intruder/getting-started)
Flag: picoCTF{3v3ry1_l0v3s_c00k135_96cdadfd}

## Challenge 2: SOAP (incomplete)

This challenge required us to read the /etc/passwd file. I clicked on the start instance option and opened the web portal. 

<img width="1265" alt="University" src="https://github.com/user-attachments/assets/d8633020-1412-49ea-81f6-8c840d068946">

On clicking ‘details’ button on the website, ‘Special Info::: Created By security and privacy experts’ was displayed. This could be used to read the /etc/asswd file.

<img width="1470" alt="Computer Science" src="https://github.com/user-attachments/assets/a59a4b96-6e55-4539-991c-c069cb3c5ccc">

On this tab, I went to developer tools to view the website’s source code.

<img width="652" alt="Sources" src="https://github.com/user-attachments/assets/bbc999ee-6918-4c47-a84d-90a0e4e5b1dd">
￼
I went to the Sources and noticed two files named detailsCheck.js and XmlDetailsCheckPayload.js in the js (javascript) folder. 

<img width="700" alt="Pasted Graphic" src="https://github.com/user-attachments/assets/e1e1792b-76c3-4757-8f9e-4b86454189bb">

In the function payload, there is an xml declaration. 
In order to exploit the xml vulnerability, I installed BurpSuite. On the browser opened by blurpsuite, I entered the url to the saturn.picoctf site and the request was intercepted by blurpsuite.

<img width="1470" alt="Pasted Graphic 2" src="https://github.com/user-attachments/assets/71847585-93db-4e35-b942-039432019757">

I then clicked on the hamburger icon in the Request tab and selected the `send to repeater` option to make changes in the xml input and test them. Then, I went back to the site, and clicked on the Details button. In order to view the request payload, I opened Network, clicked on ‘data’ followed by Payload. This was the request payload: `<?xml version="1.0" encoding="UTF-8"?><data><ID>1</ID></data>`

<img width="1470" alt="Pasted Graphic 3" src="https://github.com/user-attachments/assets/62491683-e824-4f99-8c74-2bd7a1409d6f">

￼
Then, on BurpSuite I injected the following XXE payload Into the request.
```<?xml version="1.0" encoding="UTF-8”?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM 
"file:///etc/passwd"> ]>
<data><ID>&xxe;</ID></data>
However this did not work as I made a mistake which I have explained in the Errors and mistakes column.
In order to get the request header of data I had to first click on the Open Browser button oon burpSuite, paste the URL of the website given in the challenge on the chromium browser, click the details button and then turn ON the intercept. 
￼
```
<img width="1470" alt="Pasted Graphic 4" src="https://github.com/user-attachments/assets/38eb9f19-a995-451a-8518-9ab28b0a76c1">

We can see an XML document `<?xml version="1.0" encoding="UTF-8"?><data><ID>2</ID></data>`. Then in order to manipulate it to read the /etc/passwd file, I added `<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>` to it. 

-New Concepts
  1. I came across xxe vulnerabilities and how to exploit them. In this challenge, I used it to retrieve the /etc/passwd file.


-Errors & mistakes
1. While injecting the XXE payload to read the /etc/passwd file, I typed `<data><ID>1</ID></data>` instead of `<data><ID>&xxe;</ID></data>` 
2. I was confused as to why there was no response to a request I sent. This was because the instance time had run out and I had to restart it and then edit the
3. I wasted a lot of time on trying to figure out why the method was GET instead of POST when I opened the website’s url on the  BurpSuite browser. The mistake I was doing was that I turned intercept ON since the start but instead, had to turn it off, open the url on the browser opened by BurpSuite, click on the details button and THEN turn intercept ON to get the right request on BurpSuite.



References: [xxe injection](https://www.youtube.com/watch?v=9ZokuRHo-eY)
[burpsuite intro](https://portswigger.net/burp/documentation/desktop/getting-started/intercepting-http-traffic )

Flag: 
